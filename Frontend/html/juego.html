<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Magnar WarGames - Juego</title>
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
  <link rel="stylesheet" href="../css/stylejuego.css">
</head>
<body>
    <!-- BARRA SUPERIOR (Sin cambios) -->
    <div id="top-bar">
        <div id="logo-casa-container">
             <img id="logo-casa" src="" alt="Logo de casa">
        </div>
        <div id="tropas-jugador" style="display: none;">
            <img src="../imgs/Interfaz/tropas.png" alt="Tropas">
            <span id="cantidad-tropas">0</span>
        </div>
        <div id="oro-jugador" style="display: none;">
            <img src="../imgs/Interfaz/oro.png" alt="Oro">
            <span id="cantidad-oro">0</span>
        </div>
    </div>

    <!-- Info Turno/Acci√≥n (Sin cambios) -->
    <div id="turno-jugador" class="turno-texto">Turno 1</div>
    <div id="accion-jugador" class="accion-texto">Acci√≥n 1</div>
    <div id="estado-turno"></div>

    <!-- CONTENEDOR BOTONES ACCI√ìN (Sin cambios estructurales) -->
    <div id="acciones-container">
        <button id="btn-batalla" class="btn-accion-juego">‚öîÔ∏è Batalla</button>
        <button id="btn-reclutar" class="btn-accion-juego">‚ûï Reclutar</button>
        <button id="btn-construir" class="btn-accion-juego">üî® Construir</button>
        <button id="btn-mover" class="btn-accion-juego">‚û°Ô∏è Mover/Atacar</button> <!-- Texto actualizado -->
        <button id="btn-reorganizar" class="btn-accion-juego">üîÑ Reorganizar</button>
        <!-- Podr√≠amos a√±adir botones para habilidades espec√≠ficas aqu√≠ -->
    </div>

    <!-- Modal Batalla (Sin cambios estructurales) -->
    <div id="modal-batalla" class="modal-juego" style="display: none;">
        <button id="btn-cerrar-modal-batalla" class="modal-cerrar">X</button>
        <h2>Resultado de Batalla</h2>
        <div class="campo-formulario">
            <label for="select-territorio-atacado">Territorio Atacado:</label>
            <select id="select-territorio-atacado"><option value="">-- Selecciona --</option></select>
        </div>
        <div class="campo-formulario">
            <fieldset><legend>Resultado:</legend>
                <label><input type="radio" name="resultado-batalla" value="victoria" checked> Victoria</label>
                <label><input type="radio" name="resultado-batalla" value="derrota"> Derrota</label>
            </fieldset>
        </div>
        <div class="campo-formulario campo-perdidas">
            <label for="input-perdidas-atacante">Mis P√©rdidas:</label>
            <div class="control-numero">
                <button id="btn-restar-perdidas-atacante">-</button>
                <input type="number" id="input-perdidas-atacante" value="0" min="0">
                <button id="btn-sumar-perdidas-atacante">+</button>
            </div>
        </div>
        <div class="campo-formulario campo-perdidas">
            <label for="input-perdidas-defensor">P√©rdidas Defensor:</label>
            <div class="control-numero">
                <button id="btn-restar-perdidas-defensor">-</button>
                <input type="number" id="input-perdidas-defensor" value="0" min="0">
                <button id="btn-sumar-perdidas-defensor">+</button>
            </div>
        </div>
        <div class="botones-modal">
             <button id="btn-confirmar-batalla" class="btn-confirmar">‚úîÔ∏è Confirmar</button>
             <button id="btn-cancelar-batalla" class="btn-cancelar">‚úñÔ∏è Cancelar</button>
        </div>
    </div>
    <!-- Fin Modal Batalla -->

    <!-- Modal Reclutar (NUEVO) -->
<div id="modal-reclutar" class="modal-juego" style="display: none;">
    <button class="modal-cerrar" onclick="cerrarModal('modal-reclutar')">X</button>
    <h2>Reclutar Tropas</h2>
    <div id="contenedor-reclutas" style="display: flex; justify-content: space-around; gap: 10px; flex-wrap: wrap;">
      
      <!-- Soldado -->
      <div class="recluta-box" data-tipo="soldado" data-costo="4">
        <h3>Soldado</h3>
        <img src="../imgs/reclutas/soldado.png" alt="Soldado" style="width: 80px;">
        <div class="control-numero">
          <button onclick="ajustarCantidad('soldado', -1)">-</button>
          <span id="cantidad-soldado">0</span>
          <button onclick="ajustarCantidad('soldado', 1)">+</button>
        </div>
        <p>Coste: 4 oro</p>
      </div>
  
      <!-- Mercenario -->
      <div class="recluta-box" data-tipo="mercenario" data-costo="5">
        <h3>Mercenario</h3>
        <img src="../imgs/reclutas/mercenario.png" alt="Mercenario" style="width: 80px;">
        <div class="control-numero">
          <button onclick="ajustarCantidad('mercenario', -1)">-</button>
          <span id="cantidad-mercenario">0</span>
          <button onclick="ajustarCantidad('mercenario', 1)">+</button>
        </div>
        <p>Coste: 5 oro</p>
      </div>
  
      <!-- Mercenario de √©lite -->
      <div class="recluta-box" data-tipo="elite" data-costo="7">
        <h3>Mercenario de √©lite</h3>
        <img src="../imgs/reclutas/elite.png" alt="Mercenario √©lite" style="width: 80px;">
        <div class="control-numero">
          <button onclick="ajustarCantidad('elite', -1)">-</button>
          <span id="cantidad-elite">0</span>
          <button onclick="ajustarCantidad('elite', 1)">+</button>
        </div>
        <p>Coste: 7 oro</p>
      </div>

  
    </div>
  
    <div style="margin-top: 20px; text-align: center;">
      <p>Total de oro requerido: <span id="costo-total-recluta">0</span> <img src="../imgs/Interfaz/oro.png" alt="oro" class="icono-inline"></p>
      <button class="btn-confirmar" onclick="confirmarReclutamiento()">‚úîÔ∏è Reclutar</button>
      <button class="btn-cancelar" onclick="cerrarModal('modal-reclutar')">‚úñÔ∏è Cancelar</button>
      <p id="mensaje-reclutamiento" style="color: red; margin-top: 10px;"></p>
    </div>
  </div>
    <!-- Fin Modal Reclutar -->

     <!-- Modal Construir (Sin cambios estructurales) -->
    <div id="modal-construir" class="modal-juego" style="display: none;">
        <button class="modal-cerrar" onclick="cerrarModal('modal-construir')">X</button>
        <h2>Construir Edificio</h2>
        <div class="campo-formulario">
            <label for="select-territorio-construir">Construir en:</label>
            <select id="select-territorio-construir"><option value="">-- Selecciona territorio --</option></select>
        </div>
        <div class="campo-formulario">
            <label for="select-edificio-construir">Tipo de Edificio:</label>
            <select id="select-edificio-construir">
                <option value="">-- Selecciona --</option>
                <optgroup label="Producci√≥n">
                    <option value="Granja">Granja</option>
                    <option value="Cantera">Cantera</option>
                    <option value="Mina">Mina</option>
                    <option value="Aserradero">Aserradero</option>
                </optgroup>
                 <optgroup label="Militar">
                    <option value="Castillo">Castillo</option>
                    <option value="Puerto">Puerto</option>
                    <option value="Taller de maquinaria de asedio">Taller de Asedio</option>
                 </optgroup>
            </select>
        </div>
         <div id="costo-construccion" style="text-align: center; margin-top: 15px; font-weight: bold;">
            Costo: <span id="costo-construir-valor">--</span> <img src="../imgs/Interfaz/oro.png" alt="oro" class="icono-inline">
        </div>
         <div id="limite-construccion-info" style="text-align: center; margin-top: 5px; font-size: 0.9em; color: #ccc;">
             (<span id="limite-construir-actual">0</span> / <span id="limite-construir-maximo">1</span> edificios este turno)
        </div>
        <div class="botones-modal">
             <button id="btn-confirmar-construir" class="btn-confirmar">‚úîÔ∏è Construir</button>
             <button class="btn-cancelar" onclick="cerrarModal('modal-construir')">‚úñÔ∏è Cancelar</button>
        </div>
    </div>
    <!-- Fin Modal Construir -->

    <!-- Modal Elecci√≥n M√°quina de Asedio -->
<div id="modal-elegir-asedio" class="modal-juego" style="display: none;">
  <h2>Elige una m√°quina de asedio</h2>
  <div style="display: flex; gap: 20px; justify-content: center;">
    <div onclick="elegirAsedioGratis('catapulta')" style="cursor: pointer; text-align: center;">
      <img src="../imgs/reclutas/catapulta.png" style="width: 80px;">
      <p>Catapulta</p>
    </div>
    <div onclick="elegirAsedioGratis('torre')" style="cursor: pointer; text-align: center;">
      <img src="../imgs/reclutas/torre.png" style="width: 80px;">
      <p>Torre</p>
    </div>
    <div onclick="elegirAsedioGratis('escorpion')" style="cursor: pointer; text-align: center;">
      <img src="../imgs/reclutas/escorpion.png" style="width: 80px;">
      <p>Escorpi√≥n</p>
    </div>
  </div>
</div>


    <!-- ****** ELIMINADO Modal Mover/Atacar ****** -->

    <!-- Modal Mis Territorios (Sin cambios estructurales) -->
    <div id="modal-mis-territorios" class="modal-juego" style="display: none;">
        <button id="btn-cerrar-modal-territorios" class="modal-cerrar">X</button>
        <h2>Mis Territorios (<span id="contador-territorios">0</span>)</h2>
        <p>Oro estimado al final del turno: <span id="oro-estimado-final-turno">0</span> <img src="../imgs/Interfaz/oro.png" alt="oro" class="icono-inline"></p>
        <p>Ingresos por territorios: <span id="oro-generado-territorios">0</span> <img src="../imgs/Interfaz/oro.png" alt="oro" class="icono-inline"></p>
        <div class="lista-scrollable">
            <ul id="lista-mis-territorios"><li>Cargando...</li></ul>
        </div>
         <div class="botones-modal">
             <button id="btn-ok-modal-territorios" class="btn-confirmar">OK</button>
        </div>
    </div>
    <!-- Fin Modal Mis Territorios -->

    <!-- Info Adicional (Sin cambios) -->
    <div id="info-adicional" style="position: fixed; bottom: 10px; left: 10px; background-color: rgba(0,0,0,0.7); padding: 10px; border-radius: 8px; max-width: 250px; z-index: 5;">
        <h4>Rumores Desbloqueados:</h4>
        <ul id="lista-rumores" style="list-style: none; padding: 0; margin: 0; font-size: 0.9em;">
            <li>(Ninguno)</li>
        </ul>
    </div>

    <!-- Modal para elegir recursos iniciales -->
<div id="modal-inicial" class="modal-juego" style="display: block; z-index: 9999; backdrop-filter: blur(2px);">
    <h2>‚öôÔ∏è Configura tus recursos iniciales</h2>
  
    <div class="campo-formulario">
      <label for="input-oro-inicial">üí∞ Oro inicial:</label>
      <input type="number" id="input-oro-inicial" min="0" value="50" style="width: 100%;">
    </div>
  
    <div class="campo-formulario">
      <label for="input-tropas-iniciales">üõ°Ô∏è Tropas iniciales:</label>
      <input type="number" id="input-tropas-iniciales" min="0" value="30" style="width: 100%;">
    </div>
  
    <div class="botones-modal" style="margin-top: 20px;">
      <button id="btn-confirmar-iniciales" class="btn-confirmar" style="width: 100%;">
        ‚úîÔ∏è Confirmar
      </button>
    </div>
  </div>

  <!-- Paso 1: Tropas perdidas -->
<!-- Modal Fase Neutral -->
<div id="modal-fase-neutral" class="modal-juego" style="display: none;">
  <!-- Paso 1: Tropas perdidas -->
  <div id="fase-neutral-paso1">
    <h2>¬øCu√°ntas tropas perdiste?</h2>
    <input type="number" id="input-tropas-perdidas-neutral" min="0" value="0" />
    <button id="btn-confirmar-perdidas-neutral">‚úîÔ∏è Confirmar</button>
  </div>

  <!-- Paso 2: ¬øPerdiste territorios? -->
  <div id="fase-neutral-paso2" style="display:none;">
    <h2>¬øPerdiste territorios?</h2>
    <button id="btn-si-perdi-territorios">S√≠</button>
    <button id="btn-no-perdi-territorios">No</button>
  </div>

  <!-- Paso 3: Elegir territorios perdidos -->
  <div id="fase-neutral-paso3" style="display:none;">
    <h3>Selecciona los territorios que perdiste</h3>
    <div id="lista-territorios-perdidos" class="lista-scrollable"></div>

    <button id="btn-confirmar-territorios-perdidos">‚úîÔ∏è Confirmar territorios</button>
  </div>

  <!-- Paso 4: Nuevo propietario por cada territorio -->
  <div id="fase-neutral-paso4" style="display:none;">
    <div id="contenedor-cambios-propietario"></div>
    <button id="btn-finalizar-fase-neutral">Finalizar</button>
  </div>
</div>


  <!-- ZONA DE UNIDADES MILITARES -->
<div id="zona-unidades-militares" style="position: fixed; top: 250px; left: 10px; background-color: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px; width: 180px; z-index: 10;">
  <h3 style="margin: 0 0 10px; font-size: 1.2rem; color: white; text-align: center;">‚öîÔ∏è Unidades Militares</h3>
  <ul id="lista-unidades-jugador" style="list-style: none; padding: 0; margin: 0;"></ul>
</div>


  <!-- ZONA DE EDIFICIOS -->
<div id="zona-edificios" style="position: fixed; top: 250px; right: 10px; background-color: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px; width: 180px; z-index: 10;">
    <h3 style="margin: 0 0 10px; font-size: 1.2rem; color: white; text-align: center;">üè∞ Edificios</h3>
    <ul id="lista-edificios-jugador" style="list-style: none; padding: 0; margin: 0;"></ul>
  </div>
  
  <script defer src="../javascript/scriptjuego.js"></script>
</body>
</html>